"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("react/jsx-runtime"),t=require("react-compiler-runtime"),n=require("react"),r=require("../_chunks-cjs/create-data-attribute.cjs"),o=require("../_chunks-cjs/PointerEvents.cjs"),i=require("../_chunks-cjs/mutations.cjs"),s=require("../_chunks-cjs/SharedStateContext.cjs"),a=require("@sanity/mutate"),c=require("@sanity/client/csm"),l=require("../_chunks-cjs/transformSanityNodeData.cjs"),d=require("scroll-into-view-if-needed"),u=require("@sanity/comlink"),p=require("xstate"),f=require("../_chunks-cjs/context.cjs"),h=require("rxjs"),m=require("../optimistic/index.cjs");function g(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var y=g(d);const v=e=>{const r=t.c(8),{comlink:o,history:i}=e;let s,a,c,l;return r[0]!==o||r[1]!==i?(s=()=>o?.on("presentation/navigate",(e=>{i?.update(e)})),a=[o,i],r[0]=o,r[1]=i,r[2]=s,r[3]=a):(s=r[2],a=r[3]),n.useEffect(s,a),r[4]!==o||r[5]!==i?(c=()=>{if(i)return i.subscribe((e=>{e.title=e.title||document.title,o?.post("visual-editing/navigate",e)}))},l=[o,i],r[4]=o,r[5]=i,r[6]=c,r[7]=l):(c=r[6],l=r[7]),n.useEffect(c,l),null},w=e=>{const r=t.c(3),{comlink:o}=e;let i,s;return r[0]!==o?(i=()=>{const e=()=>{o.post("visual-editing/meta",{title:document.title})},t=new MutationObserver((t=>{const[n]=t;"TITLE"===n.target.nodeName&&e()}));return t.observe(document.head,{subtree:!0,characterData:!0,childList:!0}),e(),()=>t.disconnect()},s=[o],r[0]=o,r[1]=i,r[2]=s):(i=r[1],s=r[2]),n.useEffect(i,s),null};function b(e){const t=new CustomEvent("sanity/dragEnd",{detail:e,cancelable:!0});window.dispatchEvent(t)}const x=n.createContext(null);function j(){const e=n.useContext(x);if(!e)throw new Error("Schema context is missing");return e}function k(e,t){if(!e.type)throw new Error("Node type is missing");return()=>t.patch((async({getSnapshot:t})=>i.f(e,await t())))}function E(e,t,n,r){if(!e.type)throw new Error("Node type is missing");return()=>t.patch((()=>i.a(e,n,r)))}function S(e,t){if(!e.type)throw new Error("Node type is missing");return()=>t.patch((async({getSnapshot:t})=>i.h(e,await t())))}function _(t){const{node:n,field:r,parent:i,doc:s}=t;return"arrayItem"===r?.type?async function(e){const{node:t,field:n,doc:r}=e,i=[];return i.push(...M(e)),i.push(...$(e)),i.push(...await P(e)),i.push({type:"action",label:"Insert before",icon:o.a,action:E(t,r,n.name,"before")}),i.push({type:"action",label:"Insert after",icon:o.b,action:E(t,r,n.name,"after")}),i}({node:n,field:r,doc:s}):"union"===i?.type?async function(t){const{doc:n,node:r,parent:i}=t,s=[];if(s.push(...M(t)),s.push(...$(t)),s.push(...await P(t)),i.options?.insertMenu){const t=(i.options.insertMenu||{}).views?.some((e=>"grid"===e.name))?0:void 0;s.push({type:"custom",component:({boundaryElement:o})=>e.jsx(I,{label:"Insert before",onSelect:e=>{E(r,n,e.name,"before")()},parent:i,width:t,boundaryElement:o})}),s.push({type:"custom",component:({boundaryElement:o})=>e.jsx(I,{label:"Insert after",onSelect:e=>{E(r,n,e.name,"after")()},parent:i,width:t,boundaryElement:o})})}else s.push({type:"group",label:"Insert before",icon:o.a,items:i.of.filter((e=>"unionOption"===e.type)).map((e=>({type:"action",icon:o.g(e),label:"block"===e.name?"Paragraph":e.title||e.name,action:E(r,n,e.name,"before")})))}),s.push({type:"group",label:"Insert after",icon:o.b,items:i.of.filter((e=>"unionOption"===e.type)).map((e=>({type:"action",label:"block"===e.name?"Paragraph":e.title||e.name,icon:o.g(e),action:E(r,n,e.name,"after")})))});return s}({node:n,parent:i,doc:s}):Promise.resolve([])}function M(e){const{node:t,doc:n}=e;return n?[{type:"action",label:"Duplicate",icon:o.C,action:S(t,n)}]:[]}function $(e){const{node:t,doc:n}=e;return n?[{type:"action",label:"Remove",icon:o.R,action:k(t,n)}]:[]}async function P(e,t=!0){const{node:n,doc:r}=e;if(!r)return[];const s=[],a=[],[c,l,d,u]=await Promise.all([i.e(n,r,"previous"),i.e(n,r,"next"),i.e(n,r,"first"),i.e(n,r,"last")]);return d.length&&a.push({type:"action",label:"To top",icon:o.c,action:()=>r.patch(d)}),c.length&&a.push({type:"action",label:"Up",icon:o.e,action:()=>r.patch(c)}),l.length&&a.push({type:"action",label:"Down",icon:o.f,action:()=>r.patch(l)}),u.length&&a.push({type:"action",label:"To bottom",icon:o.U,action:()=>r.patch(u)}),a.length&&(s.push({type:"group",label:"Move",icon:o.S,items:a}),t&&s.push({type:"divider"})),s}const I=n=>{const r=t.c(12),{label:i,parent:s,width:a,onSelect:c,boundaryElement:l}=n;let d,u,p,f,h;return r[0]===Symbol.for("react.memo_cache_sentinel")?(d=["left-start","right","left","right-end","left-end","bottom","top"],r[0]=d):d=r[0],r[1]===Symbol.for("react.memo_cache_sentinel")?(u=[4,4,4,4],r[1]=u):u=r[1],r[2]!==l||r[3]!==a?(p={arrow:!1,constrainSize:!0,floatingBoundary:l,padding:0,placement:"right-start",fallbackPlacements:d,preventOverflow:!0,width:a,__unstable_margins:u},r[2]=l,r[3]=a,r[4]=p):p=r[4],r[5]!==c||r[6]!==s?(f=e.jsx(o.h,{node:s,onSelect:c}),r[5]=c,r[6]=s,r[7]=f):f=r[7],r[8]!==i||r[9]!==p||r[10]!==f?(h=e.jsx(o.M,{fontSize:1,icon:o.b,padding:2,popover:p,space:2,text:i,children:f}),r[8]=i,r[9]=p,r[10]=f,r[11]=h):h=r[11],h};const D=[-4,4,-4,4];function R(n){const r=t.c(25),{node:i,onDismiss:s,boundaryElement:a}=n;let c;r[0]!==i||r[1]!==s?(c=()=>{"action"===i.type&&(i.action?.(),s?.())},r[0]=i,r[1]=s,r[2]=c):c=r[2];const l=c;if("divider"===i.type){let t;return r[3]===Symbol.for("react.memo_cache_sentinel")?(t=e.jsx(o.i,{}),r[3]=t):t=r[3],t}if("action"===i.type){const t=!i.action;let n;return r[4]!==i.hotkeys||r[5]!==i.icon||r[6]!==i.label||r[7]!==l||r[8]!==t?(n=e.jsx(o.p,{fontSize:1,hotkeys:i.hotkeys,icon:i.icon,padding:2,space:2,text:i.label,disabled:t,onClick:l}),r[4]=i.hotkeys,r[5]=i.icon,r[6]=i.label,r[7]=l,r[8]=t,r[9]=n):n=r[9],n}if("group"===i.type){const t=i.icon;let n;r[10]===Symbol.for("react.memo_cache_sentinel")?(n={arrow:!1,constrainSize:!0,placement:"right-start",fallbackPlacements:["left-start","right","left","right-end","left-end","bottom","top"],preventOverflow:!0,__unstable_margins:D},r[10]=n):n=r[10];const c=i.label;let l,d;if(r[11]!==a||r[12]!==i.items||r[13]!==s){let t;r[15]!==a||r[16]!==s?(t=(t,n)=>e.jsx(R,{node:t,onDismiss:s,boundaryElement:a},n),r[15]=a,r[16]=s,r[17]=t):t=r[17],l=i.items.map(t),r[11]=a,r[12]=i.items,r[13]=s,r[14]=l}else l=r[14];return r[18]!==i.icon||r[19]!==i.label||r[20]!==l?(d=e.jsx(o.M,{fontSize:1,icon:t,padding:2,popover:n,space:2,text:c,children:l}),r[18]=i.icon,r[19]=i.label,r[20]=l,r[21]=d):d=r[21],d}if("custom"===i.type){const{component:t}=i;let n;return r[22]!==t||r[23]!==a?(n=e.jsx(t,{boundaryElement:a}),r[22]=t,r[23]=a,r[24]=n):n=r[24],n}return null}const T=r=>{const s=t.c(43),{node:a,onDismiss:c,position:l}=r,{x:d,y:u}=l,[p,f]=n.useState(null),{getField:h}=j(),{getDocument:m}=i.u();let g;s[0]!==h||s[1]!==a?(g=h(a),s[0]=h,s[1]=a,s[2]=g):g=s[2];const{field:y,parent:v}=g;let w;w=y?.title||y?.name||"Unknown type";const b=w,[x,k]=n.useState(void 0);let E,S,M,$;s[3]!==y||s[4]!==m||s[5]!==a||s[6]!==v?(E=()=>{(async()=>{const e=m(a.id);if(!e)return;const t=await _({node:a,field:y,parent:v,doc:e});k(t)})()},S=[y,a,v,m],s[3]=y,s[4]=m,s[5]=a,s[6]=v,s[7]=E,s[8]=S):(E=s[7],S=s[8]),n.useEffect(E,S),s[9]!==d||s[10]!==u?($={getBoundingClientRect:()=>({bottom:u,left:d,right:d,top:u,width:0,height:0})},s[9]=d,s[10]=u,s[11]=$):$=s[11],M=$;const P=M;let I,T;s[12]!==y?(T=o.g(y),s[12]=y,s[13]=T):T=s[13],I=T;const q=I;let z,A;s[14]===Symbol.for("react.memo_cache_sentinel")?(z={minWidth:120,maxWidth:160},s[14]=z):z=s[14],s[15]!==q||s[16]!==x?(A=e.jsx(o.j,{flex:"none",children:x?e.jsx(o.T,{size:1,children:q}):e.jsx(o.k,{size:1})}),s[15]=q,s[16]=x,s[17]=A):A=s[17];const C=x?b:"Loading...";let F,L,N,O;s[18]!==C?(F=e.jsx(o.l,{flex:1,space:2,children:e.jsx(o.T,{size:1,weight:"semibold",children:C})}),s[18]=C,s[19]=F):F=s[19],s[20]!==A||s[21]!==F?(L=e.jsxs(o.F,{gap:2,padding:2,children:[A,F]}),s[20]=A,s[21]=F,s[22]=L):L=s[22],s[23]!==p||s[24]!==x||s[25]!==c?(N=x&&e.jsxs(e.Fragment,{children:[e.jsx(o.i,{}),x.map(((t,n)=>e.jsx(R,{node:t,onDismiss:c,boundaryElement:p},n)))]}),s[23]=p,s[24]=x,s[25]=c,s[26]=N):N=s[26],s[27]!==L||s[28]!==N?(O=e.jsxs(o.m,{style:z,children:[L,N]}),s[27]=L,s[28]=N,s[29]=O):O=s[29];const U=`${d}-${u}`;let W,G,V,B;return s[30]!==d||s[31]!==u?(W={position:"absolute",left:d,top:u},s[30]=d,s[31]=u,s[32]=W):W=s[32],s[33]!==U||s[34]!==W?(G=e.jsx("div",{style:W},U),s[33]=U,s[34]=W,s[35]=G):G=s[35],s[36]!==P||s[37]!==O||s[38]!==G?(V=e.jsx(o.n,{__unstable_margins:D,arrow:!1,open:!0,placement:"right-start",referenceElement:P,content:O,children:G}),s[36]=P,s[37]=O,s[38]=G,s[39]=V):V=s[39],s[40]!==c||s[41]!==V?(B=e.jsx(o.o,{setBoundaryElement:f,onDismiss:c,children:V}),s[40]=c,s[41]=V,s[42]=B):B=s[42],B};function q(e,t){try{const n=new URL(e,typeof location>"u"?void 0:location.origin);if(n.hash){const e=new URL(q(n.hash.slice(1),t));return`${n.origin}${n.pathname}${n.search}#${e.pathname}${e.search}`}return n.searchParams.set("preview",t),n.toString()}catch{return e}}const z=n.createContext(null);const A=o.d(o.q)`
  background-color: var(--overlay-bg);
  border-radius: 3px;
  pointer-events: none;
  position: absolute;
  will-change: transform;
  box-shadow: var(--overlay-box-shadow);
  transition: none;

  --overlay-bg: transparent;
  --overlay-box-shadow: inset 0 0 0 1px transparent;

  [data-overlays] & {
    --overlay-bg: color-mix(in srgb, transparent 95%, var(--card-focus-ring-color));
    --overlay-box-shadow: inset 0 0 0 2px
      color-mix(in srgb, transparent 50%, var(--card-focus-ring-color));
  }

  [data-fading-out] & {
    transition:
      box-shadow 1550ms,
      background-color 1550ms;

    --overlay-bg: rgba(0, 0, 255, 0);
    --overlay-box-shadow: inset 0 0 0 1px transparent;
  }

  &[data-focused] {
    --overlay-box-shadow: inset 0 0 0 1px var(--card-focus-ring-color);
  }

  &[data-hovered]:not([data-focused]) {
    transition: none;
    --overlay-box-shadow: inset 0 0 0 2px var(--card-focus-ring-color);
  }

  /* [data-unmounted] & {
    --overlay-box-shadow: inset 0 0 0 1px var(--card-focus-ring-color);
  } */

  :link {
    text-decoration: none;
  }
`,C=o.d(o.F)`
  bottom: 100%;
  cursor: pointer;
  pointer-events: none;
  position: absolute;
  right: 0;

  [data-hovered] & {
    pointer-events: all;
  }
`,F=o.d(o.q)`
  background-color: var(--card-focus-ring-color);
  right: 0;
  border-radius: 3px;

  & [data-ui='Text'] {
    color: #fff;
    white-space: nowrap;
  }
`,L=o.d(o.F)`
  bottom: 100%;
  cursor: pointer;
  pointer-events: none;
  position: absolute;
  left: 0;
`,N=o.d(o.F)`
  display: flex;
  align-items: center;
  background-color: var(--card-focus-ring-color);
  right: 0;
  border-radius: 3px;
  & [data-ui='Text'],
  & [data-sanity-icon] {
    color: #fff;
    white-space: nowrap;
  }
`;const O=r=>{const i=t.c(35),{element:s,focused:a,componentResolver:d,node:u,showActions:p,draggable:f}=r,{getField:h,getType:m}=j();let g;i[0]!==m||i[1]!==u?(g=m(u),i[0]=m,i[1]=u,i[2]=g):g=i[2];const y=g;let v;i[3]!==h||i[4]!==u?(v=h(u),i[3]=h,i[4]=u,i[5]=v):v=i[5];const{field:w,parent:b}=v;let x;i[6]!==u?(x="path"in u?function(e){const{id:t,type:n,path:r,baseUrl:o,tool:i,workspace:s}=e;return c.createEditUrl({baseUrl:o,workspace:s,tool:i,type:n,id:t,path:l.p(c.studioPath.fromString(r))})}(u):u.href,i[6]=u,i[7]=x):x=i[7];const k=x,E=function(){const e=n.useContext(z);if(!e)throw new Error("Preview Snapshots context is missing");return e}();let S;e:{if(!("path"in u)){S=void 0;break e}let e;i[8]!==u.id||i[9]!==E?(e=E.find((e=>e._id===u.id))?.title,i[8]=u.id,i[9]=E,i[10]=e):e=i[10],S=e}const _=S;let M;e:{if(!("path"in u)){M=void 0;break e}if(!w||!y){M=void 0;break e}const e=w.value.type,t=!!a;let n;i[11]!==s||i[12]!==w||i[13]!==u||i[14]!==b||i[15]!==y||i[16]!==t||i[17]!==e?(n={document:y,element:s,field:w,focused:t,node:u,parent:b,type:e},i[11]=s,i[12]=w,i[13]=u,i[14]=b,i[15]=y,i[16]=t,i[17]=e,i[18]=n):n=i[18],M=n}const $=M,P=function(e,r){const o=t.c(4);let i;e:{if(!e){i=void 0;break e}let t;if(o[0]!==e||o[1]!==r){const a=r?.(e);if(!a){i=void 0;break e}if(s=a,n.isValidElement(s)){i=a;break e}t=(Array.isArray(a)?a:[a]).map(W),o[0]=e,o[1]=r,o[2]=t,o[3]=i}else t=o[2],i=o[3];i=t}var s;return i}($,d);let I;i[19]!==y?(I=y?.icon?e.jsx("div",{dangerouslySetInnerHTML:{__html:y.icon}}):e.jsx(o.D,{}),i[19]=y,i[20]=I):I=i[20];const D=I;let R,T,q,A;return i[21]!==k||i[22]!==p?(R=p?e.jsx(C,{gap:1,paddingBottom:1,"data-sanity-overlay-element":!0,children:e.jsx(G,{href:k})}):null,i[21]=k,i[22]=p,i[23]=R):R=i[23],i[24]!==f||i[25]!==D||i[26]!==_?(T=_&&e.jsx(L,{gap:1,paddingBottom:1,children:e.jsxs(N,{gap:2,padding:2,children:[f&&e.jsx(o.j,{marginRight:1,children:e.jsx(o.T,{className:"drag-handle",size:0,children:e.jsx(o.r,{})})}),e.jsx(o.T,{size:0,children:D}),e.jsx(o.T,{size:1,weight:"medium",children:_})]})}),i[24]=f,i[25]=D,i[26]=_,i[27]=T):T=i[27],i[28]!==$||i[29]!==P?(q=Array.isArray(P)?P.map(((t,n)=>{const{component:r,props:i}=t;return e.jsx(r,{PointerEvents:o.P,...$,...i},n)})):P,i[28]=$,i[29]=P,i[30]=q):q=i[30],i[31]!==R||i[32]!==T||i[33]!==q?(A=e.jsxs(e.Fragment,{children:[R,T,q]}),i[31]=R,i[32]=T,i[33]=q,i[34]=A):A=i[34],A},U=n.memo((function(r){const o=t.c(17),{focused:i,hovered:s,rect:a,wasMaybeCollapsed:c,enableScrollIntoView:l}=r,d=n.useRef(null),u=n.useRef(!1);let p;const f=`${a.w}px`,h=`${a.h}px`,m=`translate(${a.x}px, ${a.y}px)`;let g;o[0]!==f||o[1]!==h||o[2]!==m?(g={width:f,height:h,transform:m},o[0]=f,o[1]=h,o[2]=m,o[3]=g):g=o[3],p=g;const v=p;let w,b;o[4]!==l||o[5]!==i||o[6]!==c?(w=()=>{if(!u.current&&!c&&!0===i&&d.current&&l){const e=d.current;y.default(d.current,{behavior:t=>{0!==t.length&&e.scrollIntoView({behavior:"smooth",block:"center",inline:"nearest"})},scrollMode:"if-needed",block:"center",inline:"nearest"})}u.current=!0===i},b=[i,c,l],o[4]=l,o[5]=i,o[6]=c,o[7]=w,o[8]=b):(w=o[7],b=o[8]),n.useEffect(w,b);const x=i?"":void 0,j=s?"":void 0;let k,E;return o[9]!==s||o[10]!==r?(k=s&&e.jsx(O,{...r}),o[9]=s,o[10]=r,o[11]=k):k=o[11],o[12]!==v||o[13]!==x||o[14]!==j||o[15]!==k?(E=e.jsx(A,{"data-focused":x,"data-hovered":j,ref:d,style:v,children:k}),o[12]=v,o[13]=x,o[14]=j,o[15]=k,o[16]=E):E=o[16],E}));function W(e){return"object"==typeof e&&"component"in e?e:{component:e,props:{}}}const G=n.memo((function(r){const i=t.c(6),s=n.useSyncExternalStore(V,B);let a,c;i[0]!==r.href||i[1]!==s?(c=q(r.href,s),i[0]=r.href,i[1]=s,i[2]=c):c=i[2],a=c;const l=a;let d,u;return i[3]===Symbol.for("react.memo_cache_sentinel")?(d=e.jsx(F,{padding:2,children:e.jsx(o.T,{size:1,weight:"medium",children:"Open in Studio"})}),i[3]=d):d=i[3],i[4]!==l?(u=e.jsx(o.j,{as:"a",href:l,target:"_blank",rel:"noopener noreferrer",children:d}),i[4]=l,i[5]=u):u=i[5],u}));function V(e){const t=()=>e();return window.addEventListener("popstate",t),()=>window.removeEventListener("popstate",t)}function B(){return window.location.href}const K=n=>{const r=t.c(5),{dragGroupRect:o}=n,i=`${o.y}px`,s=`${o.x}px`,a=o.w-1+"px",c=o.h-1+"px";let l;return r[0]!==i||r[1]!==s||r[2]!==a||r[3]!==c?(l=e.jsx("div",{style:{position:"absolute",top:i,left:s,width:a,height:c,border:"1px dashed #f0709b",pointerEvents:"none"}}),r[0]=i,r[1]=s,r[2]=a,r[3]=c,r[4]=l):l=r[4],l};function Y(e,t,n){return e*(1-n)+t*n}const H=({dragInsertPosition:t})=>{if(null===t)return;let n=0,r=0,o=0,i=0;const s=.0125;if("horizontal"===(t?.left||t?.right?"horizontal":"vertical")){const{left:e,right:a}=t;if(o=6,a&&e){const t=e.rect.x+e.rect.w,o=a.rect.x,c=Math.min(a.rect.h,e.rect.h)*s;n=Y(t,o,.5)-3,r=e.rect.y+c,i=Math.min(a.rect.h,e.rect.h)-2*c}else if(a&&!e){const e=a.rect.h*s;n=a.rect.x-3,r=a.rect.y+e,i=a.rect.h-2*e}else if(e&&!a){const t=e.rect.h*s;n=e.rect.x+e.rect.w-3,r=e.rect.y+t,i=e.rect.h-2*t}}else{const{bottom:e,top:a}=t;if(e&&a){const t=Math.min(a.rect.x,e.rect.x),c=a.rect.y+a.rect.h,l=e.rect.y,d=Math.min(e.rect.w,a.rect.w)*s;i=6,n=t+d,r=Y(c,l,.5)-3,o=Math.max(e.rect.w,a.rect.w)-2*d}else if(e&&!a){const t=e.rect.w*s;n=e.rect.x+t,r=e.rect.y-3,o=e.rect.w-2*t,i=6}else if(a&&!e){const e=a.rect.w*s;n=a.rect.x+e,r=a.rect.y+a.rect.h-3,o=a.rect.w-2*e,i=6}}return e.jsx("div",{style:{position:"absolute",width:`${o}px`,height:`${i}px`,transform:`translate(${n}px, ${r}px)`,background:"#556bfc",border:"2px solid white",borderRadius:"999px",zIndex:"999999"}})},X=o.d.div`
  --drag-preview-opacity: 0.98;
  --drag-preview-skeleton-stroke: #ffffff;

  @media (prefers-color-scheme: dark) {
    --drag-preview-skeleton-stroke: #383d51;
  }

  position: fixed;
  display: grid;
  transform: ${({$scaleFactor:e,$width:t,$height:n})=>`translate(calc(var(--drag-preview-x) - ${t/2}px), calc(var(--drag-preview-y) - ${n/2}px)) scale(${e})`};
  width: ${({$width:e})=>`${e}px`};
  height: ${({$height:e})=>`${e}px`};
  z-index: 9999999;
  opacity: var(--drag-preview-opacity);
  cursor: move;

  .drag-preview-content-wrapper {
    position: relative;
    width: 100%;
    height: 100%;
    container-type: inline-size;
  }

  [data-ui='card'] {
    position: relative;
    width: 100%;
    height: 100%;
  }

  .drag-preview-skeleton {
    position: absolute;
    inset: 0;

    rect {
      stroke: var(--drag-preview-skeleton-stroke);
    }
  }

  .drag-preview-handle {
    position: absolute;
    top: 4cqmin;
    left: 4cqmin;
    width: 6cqmin;
    fill: var(--drag-preview-handle-fill);
  }
`;const Z=n=>{const r=t.c(24),{skeleton:i}=n,s=Math.min(i.maxWidth,window.innerWidth/2),a=i.w>s?s/i.w:1,c=i.offsetX*a,l=i.offsetY*a,d=o.u(),u=o.s(),p=u.radius[(f=i.w,h=0,m=1920,g=1,y=u.radius.length-2,~~function(e,t,n){return e<t?t:e>n?n:e}((f-h)*(y-g)/(m-h)+g,g,y))];var f,h,m,g,y;let v;r[0]!==i.childRects?(v=i.childRects.filter(J),r[0]=i.childRects,r[1]=v):v=r[1];const w=v;let b;r[2]!==i.childRects?(b=i.childRects.filter(Q),r[2]=i.childRects,r[3]=b):b=r[3];const x=b,j=i.w,k=i.h,E=d?"dark":"light",S=`0 0 ${i.w} ${i.h}`;let _,M,$,P,I;return r[4]!==w||r[5]!==x?(_=[...w,...x],r[4]=w,r[5]=x,r[6]=_):_=r[6],r[7]!==_||r[8]!==u.color.skeleton.from?(M=_.map(((t,n)=>e.jsx("rect",{x:t.x,y:t.y,width:t.w,height:t.h,fill:u.color.skeleton.from},n))),r[7]=_,r[8]=u.color.skeleton.from,r[9]=M):M=r[9],r[10]!==S||r[11]!==M?($=e.jsx("div",{className:"drag-preview-content-wrapper",children:e.jsx("svg",{className:"drag-preview-skeleton",viewBox:S,children:M})}),r[10]=S,r[11]=M,r[12]=$):$=r[12],r[13]!==p||r[14]!==E||r[15]!==$?(P=e.jsx(o.q,{radius:p,shadow:4,overflow:"hidden",tone:"transparent",scheme:E,children:$}),r[13]=p,r[14]=E,r[15]=$,r[16]=P):P=r[16],r[17]!==c||r[18]!==l||r[19]!==a||r[20]!==i.h||r[21]!==i.w||r[22]!==P?(I=e.jsx(X,{$width:j,$height:k,$offsetX:c,$offsetY:l,$scaleFactor:a,children:P}),r[17]=c,r[18]=l,r[19]=a,r[20]=i.h,r[21]=i.w,r[22]=P,r[23]=I):I=r[23],I};function J(e){return"IMG"===e.tagName}function Q(e){return"IMG"!==e.tagName}const ee=o.d(o.q)`
  position: fixed;
  bottom: 2rem;
  left: 2rem;
`,te=()=>{const n=t.c(2);let r,i;return n[0]===Symbol.for("react.memo_cache_sentinel")?(r={zIndex:"999999"},n[0]=r):r=n[0],n[1]===Symbol.for("react.memo_cache_sentinel")?(i=e.jsx(ee,{padding:2,shadow:2,radius:2,style:r,children:e.jsxs(o.F,{align:"center",gap:2,children:[e.jsx(o.H,{keys:["Shift"]}),e.jsx(o.T,{size:1,children:"Zoom Out"}),e.jsx(o.E,{})]})}),n[1]=i):i=n[1],i},ne=(e,t)=>{const{type:n}=t;switch(n){case"element/register":return e.find((e=>e.id===t.id))?e:[...e,{id:t.id,activated:!1,element:t.element,focused:!1,hovered:!1,rect:t.rect,sanity:t.sanity,dragDisabled:t.dragDisabled}];case"element/activate":return e.map((e=>e.id===t.id?{...e,activated:!0}:e));case"element/update":return e.map((e=>e.id===t.id?{...e,sanity:t.sanity,rect:t.rect}:e));case"element/unregister":return e.filter((e=>e.id!==t.id));case"element/deactivate":return e.map((e=>e.id===t.id?{...e,activated:!1,hovered:!1}:e));case"element/mouseenter":return e.map((e=>e.id===t.id?{...e,rect:t.rect,hovered:!0}:{...e,hovered:!1}));case"element/mouseleave":return e.map((e=>e.id===t.id?{...e,hovered:!1}:e));case"element/updateRect":return e.map((e=>e.id===t.id?{...e,rect:t.rect}:e));case"element/click":return e.map((e=>({...e,focused:e.id===t.id&&"clicked"})));case"overlay/blur":case"presentation/blur":return e.map((e=>({...e,focused:!1})));case"presentation/focus":{const n=e.find((e=>"clicked"===e.focused));return e.map((e=>{const r="path"in e.sanity&&e.sanity.id===t.data.id&&e.sanity.path===t.data.path;return n&&e===n&&r?e:{...e,focused:r&&n?"duplicate":r}}))}default:return e}};function re(e,t){const{type:n}=t;let{contextMenu:r,focusPath:o,perspective:i,isDragging:s,dragInsertPosition:a,dragShowMinimap:c,dragShowMinimapPrompt:l,dragSkeleton:d,dragMinimapTransition:u,dragGroupRect:p}=e,f=!1;if("presentation/focus"===n){const n=e.focusPath;o=t.data.path,n!==o&&(f=n.slice(o.length).startsWith("["))}return"presentation/perspective"===n&&(i=t.data.perspective),"element/contextmenu"===n&&(r="sanity"in t?{node:t.sanity,position:t.position}:null),("element/click"===n||"element/mouseleave"===n||"overlay/blur"===n||"presentation/blur"===n||"presentation/focus"===n)&&(r=null),"overlay/dragUpdateInsertPosition"===n&&(a=t.insertPosition),"overlay/dragStart"===n&&(s=!0),"overlay/dragUpdateSkeleton"===t.type&&(d=t.skeleton),"overlay/dragEnd"===n&&(s=!1),"overlay/dragToggleMinimapPrompt"===t.type&&(l=t.display),"overlay/dragStartMinimapTransition"===n&&(u=!0),"overlay/dragEndMinimapTransition"===n&&(u=!1),"overlay/dragUpdateGroupRect"===n&&(p=t.groupRect),"overlay/dragToggleMinimap"===n&&(c=t.display),{...e,contextMenu:r,elements:ne(e.elements,t),dragInsertPosition:a,dragSkeleton:d,dragGroupRect:p,isDragging:s,focusPath:o,perspective:i,wasMaybeCollapsed:f,dragShowMinimap:c,dragShowMinimapPrompt:l,dragMinimapTransition:u}}const oe=function(r){const o=t.c(7),{comlink:i,children:s}=r;let a;o[0]===Symbol.for("react.memo_cache_sentinel")?(a=[],o[0]=a):a=o[0];const[c,l]=n.useState(a);let d,u,p;o[1]!==i?(d=()=>i?.on("presentation/preview-snapshots",(e=>{l(e.snapshots)})),u=[i],o[1]=i,o[2]=d,o[3]=u):(d=o[2],u=o[3]),n.useEffect(d,u),p=c;const f=p;let h;return o[4]!==s||o[5]!==f?(h=e.jsx(z.Provider,{value:f,children:s}),o[4]=s,o[5]=f,o[6]=h):h=o[6],h};function ie(e){return"path"in e}function se(e){return"document"===e.type}function ae(e){return"type"===e.type}const ce=function(r){const o=t.c(27),{comlink:i,children:s,elements:a}=r;let c;o[0]===Symbol.for("react.memo_cache_sentinel")?(c=new Map,o[0]=c):c=o[0];const[l,d]=n.useState(c),[u,p]=n.useState(null);let f;o[1]!==i?(f=async e=>{if(i)try{const t=await i.fetch("visual-editing/schema",void 0,{signal:e,suppressWarnings:!0});p(t.schema)}catch{}},o[1]=i,o[2]=f):f=o[2];const h=f;let m,g,y;o[3]!==i||o[4]!==h?(m=()=>{if(!i)return;const e=new AbortController,t=i.onStatus((()=>{h(e.signal)}),"connected");return()=>{e.abort(),t()}},g=[i,h],o[3]=i,o[4]=h,o[5]=m,o[6]=g):(m=o[5],g=o[6]),n.useEffect(m,g),o[7]===Symbol.for("react.memo_cache_sentinel")?(y=[],o[7]=y):y=o[7];const v=n.useRef(y);let w,b,j;o[8]!==i||o[9]!==a?(w=()=>{const e=new AbortController,t=function(e){return e.reduce(((e,t)=>{const{sanity:n}=t;if(!("id"in n)||!n.path.includes("[_key=="))return e;const r=function(e){return e.split(".").toReversed().reduce(((e,t)=>e.length?[t,...e]:t.includes("[_key==")?[t]:[]),[]).join(".")}(n.path);return e.find((e=>e.id===n.id&&e.path===r))||e.push({id:n.id,path:r}),e}),[])}(a);return t.some((e=>!v.current.find((t=>{const{id:n,path:r}=t;return n===e.id&&r===e.path}))))&&(async(e,t)=>{if(e.length&&i)try{const n=await i.fetch("visual-editing/schema-union-types",{paths:e},{signal:t,suppressWarnings:!0});d(n.types),v.current=e}catch{}})(t,e.signal),()=>e.abort()},b=[i,a],o[8]=i,o[9]=a,o[10]=w,o[11]=b):(w=o[10],b=o[11]),n.useEffect(w,b),o[12]!==u?(j=(e,t)=>{const n=t||"document";if(!u||"string"!=typeof e&&(!ie(e)||!Array.isArray(u)))return;const r="string"==typeof e?e:e.type,o="document"===n?se:ae;return u.filter(o).find((e=>e.name===r))},o[12]=u,o[13]=j):j=o[13];const k=j;let E;o[14]!==k||o[15]!==l?(E=e=>{if(!ie(e))return{field:void 0,parent:void 0};const t=k(e);if(!t)return{field:void 0,parent:void 0};const n=e.path.split(".").flatMap(le);try{return function t(n,r,o,i){const s=void 0===i?[]:i;if(!n)return{field:void 0,parent:void 0};const[a,...c]=r;if("fields"in n){const e=n.fields[a];if(!e&&"rest"in n)return t(n.rest,r,n,s);if(!c.length)return{field:e,parent:o};if(!e)throw new Error(`[@sanity/visual-editing] No field could be resolved at path: "${[...s,...r].join(".")}"`);return t(e.value,c,n,[...s,a])}if("array"===n.type)return t(n.of,r,n,s);if("arrayItem"===n.type)return c.length?t(n.value,c,n,[...s,a]):{field:n,parent:o};if("union"===n.type){const r=a.startsWith("[_key==")?l?.get(e.id)?.get([s.join("."),a].filter(Boolean).join("")):a;return t(n.of.find((e=>"unionOption"===e.type?e.name===r:e)),c,n,[...s,a])}if("unionOption"===n.type)return a?t(n.value,r,n,s):{field:n,parent:o};if("inline"===n.type)return t(k(n.name,"type").value,r,n,s);throw new Error(`[@sanity/visual-editing] No field could be resolved at path: "${[...s,...r].join(".")}"`)}(t,n,void 0)}catch(e){const t=e;return t instanceof Error&&console.warn(t.message),{field:void 0,parent:void 0}}},o[14]=k,o[15]=l,o[16]=E):E=o[16];const S=E;let _,M,$;o[17]!==u?(M=u||[],o[17]=u,o[18]=M):M=o[18],o[19]!==S||o[20]!==k||o[21]!==l||o[22]!==M?($={getField:S,getType:k,resolvedTypes:l,schema:M},o[19]=S,o[20]=k,o[21]=l,o[22]=M,o[23]=$):$=o[23],_=$;const P=_;let I;return o[24]!==s||o[25]!==P?(I=e.jsx(x.Provider,{value:P,children:s}),o[24]=s,o[25]=P,o[26]=I):I=o[26],I};function le(e){return e.includes("[")?e.split(/(\[.+\])/,2):[e]}const de=(e=>{let t=e;const n=new Set;return{getState:()=>t,setState:e=>{t=e(t),n.forEach((e=>e()))},subscribe:e=>(n.add(e),()=>n.delete(e))}})({}),ue=r=>{const o=t.c(11),{comlink:i,children:a}=r;let c,l,d,u,p,f;o[0]!==i?(c=()=>i?.on("presentation/shared-state",pe),l=[i],o[0]=i,o[1]=c,o[2]=l):(c=o[1],l=o[2]),n.useEffect(c,l),o[3]!==i?(d=()=>{(async function(){const e=await(i?.fetch("visual-editing/shared-state",void 0,{suppressWarnings:!0}));e&&de.setState((()=>e.state))})().catch(fe)},u=[i],o[3]=i,o[4]=d,o[5]=u):(d=o[4],u=o[5]),n.useEffect(d,u),o[6]!==i?(f={comlink:i,store:de},o[6]=i,o[7]=f):f=o[7],p=f;const h=p;let m;return o[8]!==a||o[9]!==h?(m=e.jsx(s.S.Provider,{value:h,children:a}),o[8]=a,o[9]=h,o[10]=m):m=o[10],m};function pe(e){"value"in e?de.setState((t=>({...t,[e.key]:e.value}))):de.setState((t=>Object.fromEntries(Object.entries(t).filter((t=>{const[n]=t;return n!==e.key})))))}function fe(e){console.debug(e),console.warn("[@sanity/visual-editing]: Failed to fetch shared state. Check your version of `@sanity/presentation` is up-to-date")}const he={"Visual Editing Drag Sequence Completed":(me={name:"Visual Editing Drag Sequence Completed",description:"An array is successfully reordered using drag and drop.",version:1},{type:"log",name:me.name,version:me.version,description:me.description,schema:void 0})};var me;function ge(){}function ye(e){return e.id}function ve(e){return!!e}function we(e){const{sanity:t}=e;return"id"in t?{...t,id:"isDraft"in t?`${l.D}${t.id}`:t.id}:null}const be=o.d.div`
  background-color: transparent;
  direction: ltr;
  inset: 0;
  pointer-events: none;
  position: absolute;
  width: 100%;
  height: 100%;
  z-index: ${({$zIndex:e})=>e??"9999999"};
`;function xe(e){let t,n;return t=requestAnimationFrame((()=>{n=requestAnimationFrame(e)})),()=>{void 0!==t&&cancelAnimationFrame(t),void 0!==n&&cancelAnimationFrame(n)}}const je=e=>{const r=t.c(8),{documentIds:o}=e;let s;r[0]===Symbol.for("react.memo_cache_sentinel")?(s=[],r[0]=s):s=r[0];const[a,c]=n.useState(s);let l,d;r[1]!==o?(l=()=>{c((e=>{const t=Array.from(new Set(o));return e.length===t.length&&0===e.reduce(Se,t)?.length?e:t}))},d=[o],r[1]=o,r[2]=l,r[3]=d):(l=r[2],d=r[3]),n.useEffect(l,d);const u=i.b();let p,f;return r[4]!==u||r[5]!==a?(p=()=>{for(const e of a)u.send({type:"observe",documentId:i.j(e)}),u.send({type:"observe",documentId:i.c(e)});return()=>{for(const e of a)u.send({type:"unobserve",documentId:i.j(e)}),u.send({type:"unobserve",documentId:i.c(e)})}},f=[u,a],r[4]=u,r[5]=a,r[6]=p,r[7]=f):(p=r[6],f=r[7]),n.useEffect(p,f),null},ke=e=>{const r=t.c(11),{comlink:o,dispatch:c,inFrame:l,onDrag:d,overlayEnabled:u,rootElement:p}=e,{dispatchDragEndEvent:f}=function(){const e=t.c(4),{getDocument:r}=i.u();let o,s;e[0]!==r?(o=()=>{const e=e=>{const{insertPosition:t,target:n,preventInsertDefault:o}=e.detail;if(o)return;const s=function(e){if(e){const{top:t,right:n,bottom:r,left:o}=e;if(o||t)return{node:(o??t).sanity,position:"after"};if(n||r)return{node:(n??r).sanity,position:"before"}}}(t);if(s){const e=r(n.id),{node:t,position:o}=s,{key:c,hasExplicitKey:l}=i.g(n),{path:d,key:u}=i.g(t);d&&u&&u!==c&&e.patch((async e=>{const{getSnapshot:t}=e,r=await t(),s=i.d(r,n.path);return l?[a.at(d,a.remove({_key:c})),a.at(d,a.insert(s,o,{_key:u}))]:[a.at(d,a.remove(~~c)),a.at(d,a.insert(s,o,u>c?~~u-1:~~u))]}))}};return window.addEventListener("sanity/dragEnd",e),()=>{window.removeEventListener("sanity/dragEnd",e)}},s=[r],e[0]=r,e[1]=o,e[2]=s):(o=e[1],s=e[2]),n.useEffect(o,s);const c=b;let l;return e[3]===Symbol.for("react.memo_cache_sentinel")?(l={dispatchDragEndEvent:c},e[3]=l):l=e[3],l}();let h;r[0]!==o||r[1]!==c||r[2]!==f||r[3]!==d?(h=e=>{if("element/click"===e.type){const{sanity:t}=e;o?.post("visual-editing/focus",t)}else if("overlay/activate"===e.type)o?.post("visual-editing/toggle",{enabled:!0});else if("overlay/deactivate"===e.type)o?.post("visual-editing/toggle",{enabled:!1});else if("overlay/dragEnd"===e.type){const{insertPosition:t,target:n,dragGroup:r,flow:i,preventInsertDefault:s}=e;f({insertPosition:t,target:n,dragGroup:r,flow:i,preventInsertDefault:s}),t&&function(e,t,n){if(!n)return;const r=he[e];if(!r)throw new Error(`Telemetry event: ${e} does not exist`);n.post("visual-editing/telemetry-log",{event:r,data:t})}("Visual Editing Drag Sequence Completed",null,o)}else{if("overlay/dragUpdateCursorPosition"===e.type)return void d(e.x,e.y);if("overlay/setCursor"===e.type){const{element:t,cursor:n}=e;n?t.style.cursor=n:t.style.removeProperty("cursor")}}c(e)},r[0]=o,r[1]=c,r[2]=f,r[3]=d,r[4]=h):h=r[4];const m=function(e,r,o){const a=t.c(6),c=n.useRef(),l=i.i();let d,u;return a[0]!==e||a[1]!==r||a[2]!==o||a[3]!==l?(d=()=>{if(e)return c.current=s.c({handler:r,overlayElement:e,inFrame:o,optimisticActorReady:l}),()=>{c.current?.destroy(),c.current=void 0}},u=[e,r,o,l],a[0]=e,a[1]=r,a[2]=o,a[3]=l,a[4]=d,a[5]=u):(d=a[4],u=a[5]),n.useEffect(d,u),c}(p,h,l);let g,y;return r[5]!==m.current||r[6]!==u?(g=()=>{u?m.current?.activate():m.current?.deactivate()},r[5]=m.current,r[6]=u,r[7]=g):g=r[7],r[8]!==m||r[9]!==u?(y=[m,u],r[8]=m,r[9]=u,r[10]=y):y=r[10],n.useEffect(g,y),null},Ee=a=>{const c=t.c(70),{comlink:l,componentResolver:d,inFrame:u,zIndex:p}=a,[f,h]=n.useState(),m=o.u();let g;c[0]===Symbol.for("react.memo_cache_sentinel")?(g={contextMenu:null,dragInsertPosition:null,dragShowMinimap:!1,dragShowMinimapPrompt:!1,dragSkeleton:null,elements:[],focusPath:"",isDragging:!1,perspective:"published",wasMaybeCollapsed:!1,dragMinimapTransition:!1,dragGroupRect:null},c[0]=g):g=c[0];const[y,v]=n.useReducer(re,g),{contextMenu:w,dragInsertPosition:b,dragShowMinimap:x,dragShowMinimapPrompt:j,dragSkeleton:k,elements:E,isDragging:S,perspective:_,wasMaybeCollapsed:M,dragMinimapTransition:$,dragGroupRect:P}=y,[I,D]=n.useState(null),[R,q]=n.useState(!0);let z,A,C;c[1]!==l?(z=()=>{const e=[l?.on("presentation/focus",(e=>{v({type:"presentation/focus",data:e})})),l?.on("presentation/blur",(e=>{v({type:"presentation/blur",data:e})})),l?.on("presentation/toggle-overlay",(()=>{q(_e)})),l?.onStatus((e=>{h(e)}))].filter(Boolean);return()=>e.forEach(Me)},A=[l],c[1]=l,c[2]=z,c[3]=A):(z=c[2],A=c[3]),n.useEffect(z,A),function(e,r){const o=t.c(4);let i,s;o[0]!==e||o[1]!==r?(i=()=>{const t=new AbortController;e?.fetch("visual-editing/fetch-perspective",void 0,{signal:t.signal,suppressWarnings:!0}).then((e=>{r({type:"presentation/perspective",data:e})})).catch(ge);const n=e?.on("presentation/perspective",(e=>{r({type:"presentation/perspective",data:e})}));return()=>{n?.(),t.abort()}},s=[e,r],o[0]=e,o[1]=r,o[2]=i,o[3]=s):(i=o[2],s=o[3]),n.useEffect(i,s)}(l,v),function(e,r,o){const i=t.c(7),s=n.useRef(void 0);let a;i[0]!==e?(a=(t,n)=>{e?.post("visual-editing/documents",{documents:t,perspective:n})},i[0]=e,i[1]=a):a=i[1];const c=a;let l,d;i[2]!==r||i[3]!==o||i[4]!==c?(l=()=>{const e=r.map(we).filter(ve),t=new Set(e.map(ye));if(!s.current||!function(e,t){if(e===t)return!0;if(e.size!==t.size)return!1;for(const n of e)if(!t.has(n))return!1;return!0}(t,s.current.nodeIds)||o!==s.current.perspective){const n=Array.from(t).map((t=>{const n=e.find((e=>e.id===t)),{type:r,projectId:o,dataset:i}=n;return o&&i?{_id:t,_type:r,_projectId:o,_dataset:i}:{_id:t,_type:r}}));s.current={nodeIds:t,perspective:o},c(n,o)}},d=[r,o,c],i[2]=r,i[3]=o,i[4]=c,i[5]=l,i[6]=d):(l=i[5],d=i[6]),n.useEffect(l,d)}(l,E,_),c[4]!==I?(C=(e,t)=>{I&&(I.style.setProperty("--drag-preview-x",`${e}px`),I.style.setProperty("--drag-preview-y",t-window.scrollY+"px"))},c[4]=I,c[5]=C):C=c[5];const F=C;let L,N;c[6]===Symbol.for("react.memo_cache_sentinel")?(L=()=>{const e=$e,t=e=>{r.i(e)&&q(Pe)},n=e=>{r.i(e)&&q(Ie),r.a(["mod","\\"],e)&&q(De)};return window.addEventListener("click",e),window.addEventListener("keydown",n),window.addEventListener("keyup",t),()=>{window.removeEventListener("click",e),window.removeEventListener("keydown",n),window.removeEventListener("keyup",t)}},N=[q],c[6]=L,c[7]=N):(L=c[6],N=c[7]),n.useEffect(L,N);const[O,W]=n.useState(!1),[G,V]=n.useState(!1),B=n.useRef(void 0);let Y,X,J,Q;c[8]!==R?(Y=()=>{if(R)return xe((()=>{W(!0),xe((()=>{V(!0),B.current=setTimeout((()=>{V(!1),W(!1)}),1500)}))}));B.current&&(clearTimeout(B.current),W(!1),V(!1))},X=[R],c[8]=R,c[9]=Y,c[10]=X):(Y=c[9],X=c[10]),n.useEffect(Y,X),c[11]!==E?(Q=E.flatMap(Re),c[11]=E,c[12]=Q):Q=c[12],J=Q;const ee=J;let ne;c[13]===Symbol.for("react.memo_cache_sentinel")?(ne=()=>{v({type:"overlay/blur"})},c[13]=ne):ne=c[13];const ie=ne,se=i.i();let ae;ae=se?d:void 0;const le=ae;let de;e:{if(u&&"connected"!==f||S){let e;c[14]===Symbol.for("react.memo_cache_sentinel")?(e=[],c[14]=e):e=c[14],de=e;break e}let t;c[15]!==le||c[16]!==$||c[17]!==x||c[18]!==E||c[19]!==u||c[20]!==S||c[21]!==se||c[22]!==M?(t=E.filter(Te).map((t=>{const{id:n,element:r,focused:o,hovered:i,rect:a,sanity:c,dragDisabled:l}=t,d=!l&&!!r.getAttribute("data-sanity")&&se&&E.some((e=>"id"in e.sanity&&"id"in c&&(s.s(e.sanity,c)&&e.sanity.path!==c.path)));return e.jsx(U,{componentResolver:le,element:r,enableScrollIntoView:!S&&!$&&!x,focused:o,hovered:i,node:c,rect:a,showActions:!u,draggable:d,isDragging:S||$,wasMaybeCollapsed:o&&M},n)})),c[15]=le,c[16]=$,c[17]=x,c[18]=E,c[19]=u,c[20]=S,c[21]=se,c[22]=M,c[23]=t):t=c[23],de=t}const pe=de,fe=m?"dark":"light",he=G?"":void 0,me=O?"":void 0;let Ee,Se,qe,ze,Ae,Ce,Fe,Le,Ne,Oe,Ue;return c[24]!==ee||c[25]!==_?(Ee=e.jsx(je,{documentIds:ee,perspective:_}),c[24]=ee,c[25]=_,c[26]=Ee):Ee=c[26],c[27]!==l||c[28]!==u||c[29]!==R||c[30]!==I||c[31]!==F?(Se=e.jsx(ke,{comlink:l,dispatch:v,inFrame:u,onDrag:F,overlayEnabled:R,rootElement:I}),c[27]=l,c[28]=u,c[29]=R,c[30]=I,c[31]=F,c[32]=Se):Se=c[32],c[33]!==w?(qe=w&&e.jsx(T,{...w,onDismiss:ie}),c[33]=w,c[34]=qe):qe=c[34],c[35]!==P||c[36]!==b||c[37]!==$||c[38]!==j||c[39]!==S?(ze=S&&!$&&e.jsxs(e.Fragment,{children:[b&&e.jsx(H,{dragInsertPosition:b}),j&&e.jsx(te,{}),P&&e.jsx(K,{dragGroupRect:P})]}),c[35]=P,c[36]=b,c[37]=$,c[38]=j,c[39]=S,c[40]=ze):ze=c[40],c[41]!==k||c[42]!==S?(Ae=S&&k&&e.jsx(Z,{skeleton:k}),c[41]=k,c[42]=S,c[43]=Ae):Ae=c[43],c[44]!==pe||c[45]!==he||c[46]!==me||c[47]!==Ee||c[48]!==Se||c[49]!==qe||c[50]!==ze||c[51]!==Ae||c[52]!==p?(Ce=e.jsxs(be,{"data-fading-out":he,"data-overlays":me,ref:D,$zIndex:p,children:[Ee,Se,qe,pe,ze,Ae]}),c[44]=pe,c[45]=he,c[46]=me,c[47]=Ee,c[48]=Se,c[49]=qe,c[50]=ze,c[51]=Ae,c[52]=p,c[53]=Ce):Ce=c[53],c[54]!==l||c[55]!==Ce?(Fe=e.jsx(ue,{comlink:l,children:Ce}),c[54]=l,c[55]=Ce,c[56]=Fe):Fe=c[56],c[57]!==l||c[58]!==Fe?(Le=e.jsx(oe,{comlink:l,children:Fe}),c[57]=l,c[58]=Fe,c[59]=Le):Le=c[59],c[60]!==l||c[61]!==E||c[62]!==Le?(Ne=e.jsx(ce,{comlink:l,elements:E,children:Le}),c[60]=l,c[61]=E,c[62]=Le,c[63]=Ne):Ne=c[63],c[64]!==I||c[65]!==Ne?(Oe=e.jsx(o.L,{children:e.jsx(o.t,{element:I,children:Ne})}),c[64]=I,c[65]=Ne,c[66]=Oe):Oe=c[66],c[67]!==fe||c[68]!==Oe?(Ue=e.jsx(o.v,{scheme:fe,theme:o.w,tone:"transparent",children:Oe}),c[67]=fe,c[68]=Oe,c[69]=Ue):Ue=c[69],Ue};function Se(e,t){return e.filter((e=>e!==t))}function _e(e){return!e}function Me(e){return e()}function $e(e){const t=e.target;if((o.x(t)||o.y(t)&&t.closest("a"))&&e.altKey){e.preventDefault(),e.stopPropagation();const t=new MouseEvent(e.type,{...e,altKey:!1,bubbles:!0,cancelable:!0});e.target?.dispatchEvent(t)}}function Pe(e){return!e}function Ie(e){return!e}function De(e){return!e}function Re(e){return"id"in e.sanity?[e.sanity.id]:[]}function Te(e){return e.activated||e.focused}const qe=e=>{const r=t.c(4),{comlink:o,refresh:i}=e,s=n.useRef(0),a=n.useRef(0);let c,l;return r[0]!==o||r[1]!==i?(c=()=>o.on("presentation/refresh",(e=>{if("manual"===e.source){clearTimeout(s.current);const t=i(e);if(!1===t)return;let n;o.post("visual-editing/refreshing",e),n=!1,s.current=window.setTimeout((()=>{o.post("visual-editing/refreshed",e),n=!0}),3e3),t?.finally?.((()=>{n||(clearTimeout(s.current),o.post("visual-editing/refreshed",e))}))}else if("mutation"===e.source){clearTimeout(a.current);const t=i(e);if(!1===t)return;o.post("visual-editing/refreshing",e),a.current=window.setTimeout((()=>{const t=i(e);!1!==t&&(o.post("visual-editing/refreshing",e),t?.finally?.((()=>{o.post("visual-editing/refreshed",e)}))||o.post("visual-editing/refreshed",e))}),1e3),t?.finally?.((()=>{o.post("visual-editing/refreshed",e)}))||o.post("visual-editing/refreshed",e)}})),l=[o,i],r[0]=o,r[1]=i,r[2]=c,r[3]=l):(c=r[2],l=r[3]),n.useEffect(c,l),null};function ze(e){const r=t.c(7),[o,i]=n.useState();let s,a,c,l;return r[0]!==e?(s=()=>{if(!e)return;const t=function(e){const t=new h.ReplaySubject(1),n=new h.Subject;return e.fetch("visual-editing/snapshot-welcome",void 0,{suppressWarnings:!0}).then((e=>{t.next(e.event)})).catch((()=>{})),e.on("presentation/snapshot-event",(e=>{"reconnect"===e.event.type&&t.next(e.event),"mutation"===e.event.type&&n.next(e.event)})),h.merge(t,n)}(e),n=m.createDatasetMutator(e),r=p.createActor(n,{input:{client:{withConfig:Ce},sharedListener:t}});return i(r),r.start(),()=>{r.stop(),i(void 0)}},a=[e],r[0]=e,r[1]=s,r[2]=a):(s=r[1],a=r[2]),n.useEffect(s,a),r[3]!==e||r[4]!==o?(c=()=>{if(!e||!o)return;const t=new AbortController,n=e.onStatus((()=>{e.fetch("visual-editing/features",void 0,{signal:t.signal,suppressWarnings:!0}).then((e=>{e.features.optimistic&&f.s(o)})).catch(Ae)}),"connected");return()=>{t.abort(),n()}},l=[o,e],r[3]=e,r[4]=o,r[5]=c,r[6]=l):(c=r[5],l=r[6]),n.useEffect(c,l),o}function Ae(){console.warn("[@sanity/visual-editing] Package version mismatch detected: Please update your Sanity studio to prevent potential compatibility issues.")}function Ce(){}const Fe=o=>{const i=t.c(11),{components:s,history:a,refresh:c,zIndex:l}=o,d=window.self!==window.top||window.opener,p=function(e){const o=t.c(3),i=void 0===e||e,[s,a]=n.useState();let c,l;return o[0]!==i?(c=()=>{if(!i)return;const e=u.createNode({name:"visual-editing",connectTo:"presentation"},u.createNodeMachine().provide({actors:r.b()}));a(e);const t=e.start();return()=>{t(),a(void 0)}},l=[i],o[0]=i,o[1]=c,o[2]=l):(c=o[1],l=o[2]),n.useEffect(c,l),s}(d);let f,h,m;return ze(p),i[0]!==p||i[1]!==s||i[2]!==l?(f=e.jsx(Ee,{comlink:p,componentResolver:s,inFrame:d,zIndex:l}),i[0]=p,i[1]=s,i[2]=l,i[3]=f):f=i[3],i[4]!==p||i[5]!==a||i[6]!==c?(h=p&&e.jsxs(e.Fragment,{children:[e.jsx(v,{comlink:p,history:a}),e.jsx(w,{comlink:p}),c&&e.jsx(qe,{comlink:p,refresh:c})]}),i[4]=p,i[5]=a,i[6]=c,i[7]=h):h=i[7],i[8]!==f||i[9]!==h?(m=e.jsxs(e.Fragment,{children:[f,h]}),i[8]=f,i[9]=h,i[10]=m):m=i[10],m};Fe.displayName="VisualEditing",exports.createDataAttribute=r.c,exports.useDocuments=i.u,exports.useOptimisticActor=i.b,exports.useOptimistic=s.u,exports.emptyActor=f.e,exports.createDatasetMutator=m.createDatasetMutator,exports.createDocumentMutator=m.createDocumentMutator,exports.VisualEditing=Fe;//# sourceMappingURL=index.cjs.map
